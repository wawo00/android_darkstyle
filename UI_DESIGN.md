# 应用界面结构

## 布局层次结构

```
ConstraintLayout (根布局，使用主题背景色)
│
├── MaterialToolbar (顶部工具栏)
│   └── 标题: "深色模式演示"
│
└── ScrollView (可滚动内容区域)
    │
    └── LinearLayout (垂直排列)
        │
        ├── TextView "欢迎使用深色模式演示" (24sp, 粗体, 居中)
        │
        ├── TextView "这是一个展示..." (16sp, 居中, 描述文字)
        │
        ├── MaterialCardView (当前主题信息卡片)
        │   ├── TextView "当前主题："
        │   └── TextView [动态显示: 浅色模式/深色模式/跟随系统]
        │
        ├── TextView "选择主题：" (18sp, 粗体)
        │
        ├── MaterialButton "浅色模式" (64dp 高度, 圆角 12dp)
        │
        ├── MaterialButton "深色模式" (64dp 高度, 圆角 12dp)
        │
        ├── MaterialButton "跟随系统" (64dp 高度, 圆角 12dp)
        │
        └── MaterialCardView (功能特点卡片)
            ├── TextView "主题信息" (18sp, 粗体)
            ├── TextView "应用会根据您的选择..."
            ├── TextView "功能特点：" (16sp, 粗体)
            ├── TextView "• 支持浅色/深色主题切换"
            ├── TextView "• 支持跟随系统主题"
            ├── TextView "• 使用ViewBinding"
            └── TextView "• Material Design设计"
```

## 视觉效果描述

### 浅色模式
```
┌─────────────────────────────────┐
│  深色模式演示        [紫色工具栏] │
├─────────────────────────────────┤
│                                 │
│    欢迎使用深色模式演示           │
│                                 │
│  这是一个展示Android深色模式的   │
│  示例应用。您可以使用下面的按钮  │
│  切换主题。                      │
│                                 │
│  ┌───────────────────────────┐  │
│  │ 当前主题：                 │  │
│  │ 跟随系统         [卡片]    │  │
│  └───────────────────────────┘  │
│                                 │
│  选择主题：                      │
│                                 │
│  ┌───────────────────────────┐  │
│  │    浅色模式      [按钮]    │  │
│  └───────────────────────────┘  │
│                                 │
│  ┌───────────────────────────┐  │
│  │    深色模式      [按钮]    │  │
│  └───────────────────────────┘  │
│                                 │
│  ┌───────────────────────────┐  │
│  │   跟随系统       [按钮]    │  │
│  └───────────────────────────┘  │
│                                 │
│  ┌───────────────────────────┐  │
│  │ 主题信息                   │  │
│  │                           │  │
│  │ 应用会根据您的选择自动切换 │  │
│  │ 主题颜色、文本颜色和背景   │  │
│  │ 颜色。                     │  │
│  │                           │  │
│  │ 功能特点：                 │  │
│  │ • 支持浅色/深色主题切换    │  │
│  │ • 支持跟随系统主题         │  │
│  │ • 使用ViewBinding          │  │
│  │ • Material Design设计     │  │
│  └───────────────────────────┘  │
│                                 │
└─────────────────────────────────┘
```

### 深色模式
```
┌─────────────────────────────────┐
│  深色模式演示      [深紫色工具栏] │
├─────────────────────────────────┤
│        [深色背景 #121212]        │
│                                 │
│    欢迎使用深色模式演示           │
│         [白色文字]               │
│                                 │
│  这是一个展示Android深色模式的   │
│  示例应用。您可以使用下面的按钮  │
│  切换主题。                      │
│         [灰白色文字]             │
│                                 │
│  ┌───────────────────────────┐  │
│  │ 当前主题：    [深色卡片]   │  │
│  │ 深色模式                   │  │
│  └───────────────────────────┘  │
│                                 │
│  选择主题：                      │
│                                 │
│  ┌───────────────────────────┐  │
│  │   浅色模式    [Material按钮]│ │
│  └───────────────────────────┘  │
│                                 │
│  ┌───────────────────────────┐  │
│  │   深色模式    [Material按钮]│ │
│  └───────────────────────────┘  │
│                                 │
│  ┌───────────────────────────┐  │
│  │  跟随系统     [Material按钮]│ │
│  └───────────────────────────┘  │
│                                 │
│  ┌───────────────────────────┐  │
│  │ 主题信息     [深色卡片]    │  │
│  │                           │  │
│  │ [功能说明 - 白色/灰白文字] │  │
│  │                           │  │
│  └───────────────────────────┘  │
│                                 │
└─────────────────────────────────┘
```

## 颜色方案

### 浅色主题
- **背景色**: `#FFFFFF` (白色)
- **表面色**: `#F5F5F5` (浅灰)
- **主色调**: `#6200EE` (紫色)
- **文本色**: `#000000` (黑色)
- **次要文本**: `#666666` (深灰)

### 深色主题
- **背景色**: `#121212` (深灰，不是纯黑)
- **表面色**: `#1E1E1E` (稍浅的深灰)
- **主色调**: `#BB86FC` (浅紫色)
- **文本色**: `#FFFFFF` (白色)
- **次要文本**: `#BBBBBB` (浅灰)

## 交互流程

```
用户打开应用
    ↓
自动加载保存的主题设置
    ↓
显示当前主题
    ↓
用户点击主题按钮 (浅色/深色/系统)
    ↓
应用切换主题 (AppCompatDelegate.setDefaultNightMode)
    ↓
保存选择到 SharedPreferences
    ↓
更新"当前主题"显示
    ↓
界面立即刷新为新主题
```

## 特性说明

1. **即时生效**: 点击按钮后主题立即切换，无需重启应用
2. **持久化**: 应用关闭后重新打开，保持之前的主题选择
3. **系统跟随**: 选择"跟随系统"时，系统切换深浅模式，应用自动跟随
4. **Material Design**: 使用 Material 3 组件，符合最新设计规范
5. **响应式**: 支持不同屏幕尺寸，内容可滚动
6. **无障碍**: 良好的对比度，符合无障碍设计标准

## 代码亮点

### ViewBinding 使用
```kotlin
// 在 MainActivity 中
private lateinit var binding: ActivityMainBinding

// onCreate 中初始化
binding = ActivityMainBinding.inflate(layoutInflater)
setContentView(binding.root)

// 访问视图元素
binding.btnLightMode.setOnClickListener { ... }
binding.tvCurrentTheme.text = getString(R.string.light_mode)
```

### 主题切换核心代码
```kotlin
private fun setTheme(themeMode: Int) {
    // 保存到 SharedPreferences
    sharedPreferences.edit().putInt(KEY_THEME_MODE, themeMode).apply()
    
    // 应用主题
    when (themeMode) {
        THEME_LIGHT -> AppCompatDelegate.setDefaultNightMode(MODE_NIGHT_NO)
        THEME_DARK -> AppCompatDelegate.setDefaultNightMode(MODE_NIGHT_YES)
        THEME_SYSTEM -> AppCompatDelegate.setDefaultNightMode(MODE_NIGHT_FOLLOW_SYSTEM)
    }
    
    // 更新UI
    updateCurrentThemeText()
}
```

这个演示应用完整展示了 Android 深色模式的实现方法，代码简洁清晰，注释详细，是学习 Android 主题开发的优秀示例。
